# Simulointiputken ohjelmarakenne ja lohkot

1. create_simulation_directory.py
   - Luo snapshot-kansion ja kopioi lähtötiedot

2. process_production.py
   - Käsittelee Production.csv, alustaa erät

3. generate_matrix_original.py
   - Luo alkuperäisen line-matriisin (Station–Stage)

4. generate_tasks.py
   - Luo nostintehtävät line-matriisista
   - Tallentaa transporter_tasks_raw.csv ja _ordered.csv

5. resolve_station_conflicts.py
   - Korjaa asema- ja ajoitusristiriidat (_resolved)
   - Ehdot: 1) eri erät, 2) edellisen nostoasema = seuraavan laskuasema, 3) seuraavan laskuaika < edellisen nostoaika

6. stretch_transporter_tasks.py
   - Venyttää tehtäviä siirtovälin mukaan (_stretched)
   - Päivittää ohjelmatiedostot ja aikataulut

7. update_programs.py
   - Päivittää ohjelmien CalcTime-kentät

8. generate_matrix_stretched.py
   - Luo uusi line-matriisi venytettyjen tehtävien mukaan

9. visualize_comparison.py / visualize_stretched_matrix.py
   - Piirtää visuaalisen vertailun ennen–jälkeen

---

## Tiedostojen ja datan kulku

- Kaikki vaiheet käyttävät ja tuottavat snapshot-kansion tiedostoja (CSV, HTML, PNG).
- Jokainen vaihe ottaa vastaan output_dir-parametrin.
- Tiedostot tallennetaan vaiheittain: esim. transporter_tasks_raw.csv → transporter_tasks_ordered.csv → transporter_tasks_resolved.csv → transporter_tasks_stretched.csv.

---

## Lohkojen tehtävät lyhyesti

- create_simulation_directory.py: Luo snapshot-kansion ja kopioi lähtötiedot.
- process_production.py: Käsittelee tuotantoerät (Production.csv).
- generate_matrix_original.py: Luo alkuperäisen line-matriisin (asema–vaihe).
- generate_tasks.py: Muuntaa matriisin nostintehtäviksi.
- resolve_station_conflicts.py: Korjaa asema- ja ajoitusristiriidat (tekee _resolved-listan).
- stretch_transporter_tasks.py: Venyttää tehtäviä siirtovälin mukaan, päivittää ohjelmat ja aikataulut (_stretched).
- update_programs.py: Päivittää ohjelmien CalcTime-kentät.
- generate_matrix_stretched.py: Luo uusi line-matriisi venytettyjen tehtävien mukaan.
- visualize_comparison.py / visualize_stretched_matrix.py: Piirtää visuaalisen vertailun ennen–jälkeen.
